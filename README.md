# A Human-AI Assisted Methodology for the Generation of a Cybersecurity Controls Library

**Abstract**— Security frameworks are important tools to govern organizations' cybersecurity, but their creation and update require significant time and human effort to avoid leaving organizations with fragmented regulations. This work proposes a methodology to use Generative AI to assist the risk assessor, using AI to analyze documents and recommend useful excerpts, transforming them into controls and assisting in results review. The methodology was validated over 55 documents, half analyzed by the human expert, with the results compared using the AI model to tune it. The second half is analyzed by the model, and the expert reviewed the results. The AI provides a confidence degree in the analysis and automatically annotates the document excerpts. These tests demonstrated comparable accuracy and greatly analysis time reduction.
Two controls libraries were generated as case study. One for the NIST Cybersecurity Framework 2.0 regarding cybersecurity of generative AI, the other for the NIS 2 directive.

**Index Terms**—Cyber Risk Assessment, Generative AI, Human-Centered AI, LLM, Cybersecurity Framework

**Important material (with example images):**

- **Prompts:** Inside this folder there are all the AI prompt developed and used for this work. "Prompt first half" and "Prompt second half" are the prompt used, one after the other, to obtain the relevant excerpt from a given document. "Prompt confidence" is used to make the AI give the confidence degrees of the analysis results. "Prompt mapping" is used to make the AI give suggestions on mapping the relevant excerpts on a framework's core subcategories. Notice that the AI require also the core to work, and that the positive example of this prompt are from the NIST cybersecurity framework 2.0.

- **List and characterization of collected documents.xlsx** Contains all the collected documents' data, category (best practice, standard, norm) and link.

<img width="581" alt="image" src="https://github.com/user-attachments/assets/e6ed4d4c-312c-4f95-8548-05cb6ec88645" />

- **Final prototype:** This folder contains the framework contextualization prototype and the implementation guides.

<img width="581" alt="image" src="https://github.com/user-attachments/assets/19c0cb3d-5fa8-4651-89fd-50b183c62f69" />

- **Assisted results review scripts:** This folder contains the two scripts used for the visual aid in the automated analysis results review and the launcher for both.
- Results.py takes in input the AI analysis generated CVS, and return an HTML file with a two pie charts, one for the NIST Cybersecurity Framework, and one for the NIST Privacy Framework, showing the excerpts coverage of the framework's functions, and two bar charts, one showing the excertps distribution by consifende level, and one showing the distribution for confidence level of the excerpts marked as "definintion". This script takes in input the final CSV resulting from the entire analysis process, the one obtained with the final part of the AI prompt "Prompt mapping.odt". The resulting CSV has the following format: "page@text@First proposal@Second proposal@Third proposal@labels@confidence@definitions".
- Match.py takes in input the CSV file containing the risk assessor expert analysis results and the the AI analysis generated CVS, and return an HTML file with a list of the number of true positive, false negative, and false positive, and their percentage, a confusion matrix summarizing these results, four pie charts, grouping the excerpts by their confidence degree, resulting from the AI analysis, and showing the number and percentage of these excerpts that are effectively useful or useless, based on the match results, and two bar charts, one showing the excertps distribution by consifende level, and one showing the distribution for confidence level of the excerpts marked as "definintion". This script takes in input a CSV resulting from the expert manual analysis, having the following format "Page,Details,", where "Details" contains the text of the excerpts, and a CSV resulting from the AI analysis. The script searches the CSV for the following fields "Page,Text,Confidence,Definition Label". The resulting CSV using for the testing were generated with the AI prompt "Prompt confidence.odt".
Both scripts automatically generate an HTML page to help in the analysis results review. It is also present a text file with the instruction.

<img width="581" alt="image" src="https://github.com/user-attachments/assets/c4a0c131-5da5-4829-a345-7c116127a828" />

- **NIS 2 study case:** This folder contains all the material of the NIS 2 study case. It contains the resulting CSVs from the AI analysis, and the final CSV with the results reviewed by the risk assessor expert. It also contains the HTML pages automatically generated by the scripts used for the results review.

<img width="581" alt="results" src="https://github.com/user-attachments/assets/4b445a3f-7a34-47ef-a997-4bed8dbd0e14" />

